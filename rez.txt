

/usr/local/lib/python3.6/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Training with validation set of size 2000
2018-05-31 22:09:01.925612: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-05-31 22:09:01.926270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:00:04.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 22:09:01.926345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0
2018-05-31 22:09:02.168541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-05-31 22:09:02.168665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 
2018-05-31 22:09:02.168690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N 
2018-05-31 22:09:02.169123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10765 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7)
Epoch 0 : 1.841416
Accuracy: 0.357
**************************************************
Epoch 1 : 1.6043931
Accuracy: 0.4405
**************************************************
Epoch 2 : 1.4994107
Accuracy: 0.4775
**************************************************
Epoch 3 : 1.4369557
Accuracy: 0.502
**************************************************
Epoch 4 : 1.3825331
Accuracy: 0.5195
**************************************************
Epoch 5 : 1.3330133
Accuracy: 0.539
**************************************************
Epoch 6 : 1.2852584
Accuracy: 0.555
**************************************************
Epoch 7 : 1.2414701
Accuracy: 0.5635
**************************************************
Epoch 8 : 1.1993527
Accuracy: 0.5795
**************************************************
Epoch 9 : 1.1643285
Accuracy: 0.59
**************************************************
Epoch 10 : 1.1311724
Accuracy: 0.607
**************************************************
Epoch 11 : 1.1014775
Accuracy: 0.6125
**************************************************
Epoch 12 : 1.0735055
Accuracy: 0.6215
**************************************************
Epoch 13 : 1.048319
Accuracy: 0.6285
**************************************************
Epoch 14 : 1.0254402
Accuracy: 0.631
**************************************************
Epoch 15 : 1.0039496
Accuracy: 0.637
**************************************************
Epoch 16 : 0.9835057
Accuracy: 0.644
**************************************************
Epoch 17 : 0.96525097
Accuracy: 0.6525
**************************************************
Epoch 18 : 0.94623834
Accuracy: 0.6585
**************************************************
Epoch 19 : 0.92799544

Accuracy: 0.664
**************************************************
Epoch 20 : 0.9116182
Accuracy: 0.6685
**************************************************
Epoch 21 : 0.8948402
Accuracy: 0.675
**************************************************
Epoch 22 : 0.88017416
Accuracy: 0.6795
**************************************************
Epoch 23 : 0.8662441
Accuracy: 0.6805
**************************************************
Epoch 24 : 0.85251594
Accuracy: 0.6845
**************************************************
Epoch 25 : 0.8386411
Accuracy: 0.688
**************************************************
Epoch 26 : 0.82687306
Accuracy: 0.69
**************************************************
Epoch 27 : 0.8152423
Accuracy: 0.6935
**************************************************
Epoch 28 : 0.80269074
Accuracy: 0.694
**************************************************
Epoch 29 : 0.7908679
Accuracy: 0.696
**************************************************
Epoch 30 : 0.7800013
Accuracy: 0.6975
**************************************************
Epoch 31 : 0.76948225
Accuracy: 0.699
**************************************************
Epoch 32 : 0.75844294
Accuracy: 0.7015
**************************************************
Epoch 33 : 0.7483098
Accuracy: 0.6995
**************************************************
Epoch 34 : 0.7378632
Accuracy: 0.7005
**************************************************
Epoch 35 : 0.7274554
Accuracy: 0.7025
**************************************************
Epoch 36 : 0.7172451
Accuracy: 0.704
**************************************************
Epoch 37 : 0.7079857
Accuracy: 0.707
**************************************************
Epoch 38 : 0.698597
Accuracy: 0.7075
**************************************************
Epoch 39 : 0.689738
Accuracy: 0.7115
**************************************************
Epoch 40 : 0.6800036
Accuracy: 0.712
**************************************************
Epoch 41 : 0.66994494
Accuracy: 0.715
**************************************************
Epoch 42 : 0.66122377
Accuracy: 0.714
**************************************************
Epoch 43 : 0.6520663
Accuracy: 0.7165
**************************************************
Epoch 44 : 0.64375776
Accuracy: 0.7175
**************************************************
Epoch 45 : 0.6353142
Accuracy: 0.7175
**************************************************
Epoch 46 : 0.6268627
Accuracy: 0.717
**************************************************
Epoch 47 : 0.6183135
Accuracy: 0.7205
**************************************************
Epoch 48 : 0.6090962
Accuracy: 0.7195
**************************************************
Epoch 49 : 0.60087
Accuracy: 0.719
**************************************************
Epoch 50 : 0.59337485
Accuracy: 0.7195
**************************************************
Epoch 51 : 0.58526003
Accuracy: 0.7195
**************************************************
Epoch 52 : 0.5778966

Accuracy: 0.7205
**************************************************
Epoch 53 : 0.5702965
Accuracy: 0.7195
**************************************************
Epoch 54 : 0.5625098
Accuracy: 0.7195
**************************************************
Epoch 55 : 0.55363435
Accuracy: 0.72
**************************************************
Epoch 56 : 0.5477722
Accuracy: 0.7185
**************************************************
Epoch 57 : 0.5397075
Accuracy: 0.7195
**************************************************
Epoch 58 : 0.5319953
Accuracy: 0.72
**************************************************
Epoch 59 : 0.5242367
Accuracy: 0.723
**************************************************
Epoch 60 : 0.517774
Accuracy: 0.723
**************************************************
Epoch 61 : 0.51057404
Accuracy: 0.7245
**************************************************
Epoch 62 : 0.50369424
Accuracy: 0.7245
**************************************************
Epoch 63 : 0.49563846
Accuracy: 0.725
**************************************************
Epoch 64 : 0.48793042
Accuracy: 0.7285
**************************************************
Epoch 65 : 0.48323038
Accuracy: 0.733
**************************************************
Epoch 66 : 0.4753918
Accuracy: 0.7325
**************************************************
Epoch 67 : 0.46757838
Accuracy: 0.7315
**************************************************
Epoch 68 : 0.46004304
Accuracy: 0.735
**************************************************
Epoch 69 : 0.4530621
Accuracy: 0.731
**************************************************
Epoch 70 : 0.4464664
Accuracy: 0.728
**************************************************
Epoch 71 : 0.43825
Accuracy: 0.731
**************************************************
Epoch 72 : 0.4349197
Accuracy: 0.73
**************************************************
Epoch 73 : 0.42415333
Accuracy: 0.7305
**************************************************
Epoch 74 : 0.42024788
Accuracy: 0.7295
**************************************************
Epoch 75 : 0.41013864
Accuracy: 0.732
**************************************************
Epoch 76 : 0.4059615
Accuracy: 0.7295
**************************************************
Epoch 77 : 0.39636645
Accuracy: 0.732
**************************************************
Epoch 78 : 0.39005786
Accuracy: 0.7275
**************************************************
Epoch 79 : 0.38198617
Accuracy: 0.732
**************************************************
Epoch 80 : 0.38245445
Accuracy: 0.7305
**************************************************
Epoch 81 : 0.36864832
Accuracy: 0.7325
**************************************************
Epoch 82 : 0.3683678
Accuracy: 0.7275
**************************************************
Epoch 83 : 0.3567827
Accuracy: 0.73
**************************************************
Epoch 84 : 0.34736496
Accuracy: 0.732
**************************************************
Epoch 85 : 0.3403748

Accuracy: 0.7305
**************************************************
Epoch 86 : 0.3348709
Accuracy: 0.729
**************************************************
Epoch 87 : 0.3336437
Accuracy: 0.728
**************************************************
Epoch 88 : 0.32910636
Accuracy: 0.728
**************************************************
Epoch 89 : 0.32486612
Accuracy: 0.725
**************************************************
Epoch 90 : 0.32413378
Accuracy: 0.7265
**************************************************
Epoch 91 : 0.30259496
Accuracy: 0.725
**************************************************
Epoch 92 : 0.2971278
Accuracy: 0.73
**************************************************
Epoch 93 : 0.32115912
Accuracy: 0.7225
**************************************************
Epoch 94 : 0.28268915
Accuracy: 0.729
**************************************************
Epoch 95 : 0.28791508
Accuracy: 0.727
**************************************************
Epoch 96 : 0.29540968
Accuracy: 0.72
**************************************************
Epoch 97 : 0.26430672
Accuracy: 0.7325
**************************************************
Epoch 98 : 0.28782138
Accuracy: 0.721
**************************************************
Epoch 99 : 0.25331855
Accuracy: 0.729
**************************************************
Epoch 100 : 0.25437835
Accuracy: 0.7285
**************************************************
Epoch 101 : 0.24506669
Accuracy: 0.7285
**************************************************
Epoch 102 : 0.2425208
Accuracy: 0.7255
**************************************************
Epoch 103 : 0.23285209
Accuracy: 0.7245
**************************************************
Epoch 104 : 0.23925744
Accuracy: 0.724
**************************************************
Epoch 105 : 0.22420123
Accuracy: 0.7305
**************************************************
Epoch 106 : 0.21844657
Accuracy: 0.7275
**************************************************
Epoch 107 : 0.21277225
Accuracy: 0.7255
**************************************************
Epoch 108 : 0.2026237
Accuracy: 0.731
**************************************************
Epoch 109 : 0.21070567
Accuracy: 0.7255
**************************************************
Epoch 110 : 0.19766858
Accuracy: 0.7245
**************************************************
Epoch 111 : 0.19314016
Accuracy: 0.724
**************************************************
Epoch 112 : 0.1963702
Accuracy: 0.7235
**************************************************
Epoch 113 : 0.18760058
Accuracy: 0.726
**************************************************
Epoch 114 : 0.18647204
Accuracy: 0.723
**************************************************
Epoch 115 : 0.16957013
Accuracy: 0.726
**************************************************
Epoch 116 : 0.17122807
Accuracy: 0.7195
**************************************************
Epoch 117 : 0.16464724
Accuracy: 0.721
**************************************************
Epoch 118 : 0.17080273

Accuracy: 0.72
**************************************************
Epoch 119 : 0.15571819
Accuracy: 0.7165
**************************************************
Epoch 120 : 0.1552262
Accuracy: 0.7145
**************************************************
Epoch 121 : 0.3846753
Accuracy: 0.6885
**************************************************
Epoch 122 : 0.14250813
Accuracy: 0.72
**************************************************
Epoch 123 : 0.14193231
Accuracy: 0.714
**************************************************
Epoch 124 : 0.13700287
Accuracy: 0.713
**************************************************
Epoch 125 : 0.13249002
Accuracy: 0.7185
**************************************************
Epoch 126 : 0.12824315
Accuracy: 0.7185
**************************************************
Epoch 127 : 0.12231002
Accuracy: 0.72
**************************************************
Epoch 128 : 0.119133525
Accuracy: 0.7185
**************************************************
Epoch 129 : 0.11845426
Accuracy: 0.721
**************************************************
Epoch 130 : 0.26356357
Accuracy: 0.7075
**************************************************
Epoch 131 : 0.11786468
Accuracy: 0.7175
**************************************************
Epoch 132 : 0.10674157
Accuracy: 0.718
**************************************************
Epoch 133 : 0.12328011
Accuracy: 0.7165
**************************************************
Epoch 134 : 0.119457826
Accuracy: 0.7175
**************************************************
Epoch 135 : 0.09948284
Accuracy: 0.721
**************************************************
Epoch 136 : 0.09376815
Accuracy: 0.7205
**************************************************
Epoch 137 : 0.090052575
Accuracy: 0.7195
**************************************************
Epoch 138 : 0.08658778
Accuracy: 0.7195
**************************************************
Epoch 139 : 0.08349856
Accuracy: 0.72
**************************************************
Epoch 140 : 0.08087876
Accuracy: 0.7195
**************************************************
Epoch 141 : 0.07830535
Accuracy: 0.718
**************************************************
Epoch 142 : 0.09437611
Accuracy: 0.7205
**************************************************
Epoch 143 : 0.08487623
Accuracy: 0.7195
**************************************************
Epoch 144 : 0.07310007
Accuracy: 0.7165
**************************************************
Epoch 145 : 0.0700318
Accuracy: 0.716
**************************************************
Epoch 146 : 0.06720307
Accuracy: 0.715
**************************************************
Epoch 147 : 0.06473281
Accuracy: 0.7145
**************************************************
Epoch 148 : 0.061982717
Accuracy: 0.715
**************************************************
Epoch 149 : 0.060208175
Accuracy: 0.7165
**************************************************
Epoch 150 : 0.057995316
Accuracy: 0.717
**************************************************

Epoch 151 : 0.05616105
Accuracy: 0.7165
**************************************************
Epoch 152 : 0.05413088
Accuracy: 0.716
**************************************************
Epoch 153 : 0.052235525
Accuracy: 0.719
**************************************************
Epoch 154 : 0.050890174
Accuracy: 0.7205
**************************************************
Epoch 155 : 0.049253218
Accuracy: 0.7205
**************************************************
Epoch 156 : 0.047664974
Accuracy: 0.721
**************************************************
Epoch 157 : 0.046403248
Accuracy: 0.721
**************************************************
Epoch 158 : 0.044984624
Accuracy: 0.722
**************************************************
Epoch 159 : 0.043608382
Accuracy: 0.72
**************************************************
Epoch 160 : 0.04257117
Accuracy: 0.72
**************************************************
Epoch 161 : 0.041246258
Accuracy: 0.72
**************************************************
Epoch 162 : 0.04017049
Accuracy: 0.72
**************************************************
Epoch 163 : 0.03896296
Accuracy: 0.72
**************************************************
Epoch 164 : 0.03795846
Accuracy: 0.7195
**************************************************
Epoch 165 : 0.036957514
Accuracy: 0.719
**************************************************
Epoch 166 : 0.03578279
Accuracy: 0.7195
**************************************************
Epoch 167 : 0.035068396
Accuracy: 0.719
**************************************************
Epoch 168 : 0.033975888
Accuracy: 0.7185
**************************************************
Epoch 169 : 0.03307863
Accuracy: 0.717
**************************************************
Epoch 170 : 0.032170627
Accuracy: 0.718
**************************************************
Epoch 171 : 0.031438913
Accuracy: 0.7185
**************************************************
Epoch 172 : 0.03056742
Accuracy: 0.718
**************************************************
Epoch 173 : 0.029920323
Accuracy: 0.719
**************************************************
Epoch 174 : 0.029196894
Accuracy: 0.7185
**************************************************
Epoch 175 : 0.028376693
Accuracy: 0.7185
**************************************************
Epoch 176 : 0.02756251
Accuracy: 0.719
**************************************************
Epoch 177 : 0.026857182
Accuracy: 0.7185
**************************************************
Epoch 178 : 0.026143325
Accuracy: 0.7185
**************************************************
Epoch 179 : 0.025654258
Accuracy: 0.718
**************************************************
Epoch 180 : 0.024845703
Accuracy: 0.717
**************************************************
Epoch 181 : 0.024151647
Accuracy: 0.7175
**************************************************
Epoch 182 : 0.02354872
Accuracy: 0.718
**************************************************
Epoch 183 : 0.02290237
Accuracy: 0.718
**************************************************

Epoch 184 : 0.02229726
Accuracy: 0.7175
**************************************************
Epoch 185 : 0.021690836
Accuracy: 0.718
**************************************************
Epoch 186 : 0.02112877
Accuracy: 0.7175
**************************************************
Epoch 187 : 0.02060979
Accuracy: 0.7175
**************************************************
Epoch 188 : 0.020051107
Accuracy: 0.718
**************************************************
Epoch 189 : 0.019519996
Accuracy: 0.7175
**************************************************
Epoch 190 : 0.019027026
Accuracy: 0.7185
**************************************************
Epoch 191 : 0.018564172
Accuracy: 0.7185
**************************************************
Epoch 192 : 0.018077055
Accuracy: 0.7185
**************************************************
Epoch 193 : 0.017586859
Accuracy: 0.7195
**************************************************
Epoch 194 : 0.017128423
Accuracy: 0.7185
**************************************************
Epoch 195 : 0.01670226
Accuracy: 0.718
**************************************************
Epoch 196 : 0.016272131
Accuracy: 0.719
**************************************************
Epoch 197 : 0.015878886
Accuracy: 0.719
**************************************************
Epoch 198 : 0.015494013
Accuracy: 0.7195
**************************************************
Epoch 199 : 0.015064918
Accuracy: 0.72
**************************************************

************************* TEST *************************
Confusion matrix:
 [[714  13  74  26  36   9   8  10  56  54]
 [ 10 790   6  11   7   4   6   8  20 138]
 [ 45   5 612  64 111  56  42  40  15  10]
 [ 13  14  74 552  81 141  58  42   8  17]
 [ 11   3  65  75 713  20  27  72   8   6]
 [ 13   4  48 195  68 586  18  55   4   9]
 [  7   4  43  78  73  21 756   6   5   7]
 [  5   4  34  40  76  44   5 781   0  11]
 [ 51  39  14  18  15   3   4   9 806  41]
 [ 14  53   6  15  10   5   4  24  27 842]]
Accuracy: 0.7152
Precision: 0.7210087943761397
Recall: 0.7152
*******************************************************

Gaussian noise
************************* TEST *************************
Confusion matrix:
 [[ 11  12   0   0  20   1  48   1   3 904]
 [  0  46   0   0   1   0  45   1   1 906]
 [  1   8   1   0  17   0 197   2   0 774]
 [  0  16   0   3  13   0 159   0   1 808]
 [  0   1   1   0  22   0 269   4   0 703]
 [  2   8   0   0   9   0 173   5   3 800]
 [  0   6   0   1   3   0 377   1   0 612]
 [  0   5   0   0  10   0 137  18   0 830]
 [  1  13   0   0   8   0  33   1   8 936]
 [  0   3   0   0   0   0  24   0   0 973]]
Accuracy: 0.1459
Precision: 0.4008073161758928
Recall: 0.1459
*******************************************************